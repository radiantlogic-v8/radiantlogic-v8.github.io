{"componentChunkName":"component---src-templates-base-page-js","path":"/ia/version-1.4/run-ops/upgrading/","result":{"data":{"pageContent":{"html":"<h1 id=\"upgrading-the-application\">Upgrading the application</h1>\n<blockquote>\n<p>[!warning] It is <strong>always</strong> recommended to perform a backup of the application before running the upgrade.<br>\nSee <a href=\"backup-restore.md\">here</a> for more information</p>\n</blockquote>\n<h2 id=\"upgrading-the-cli\">Upgrading the CLI</h2>\n<p>To upgrade the version of the CLI.</p>\n<ol>\n<li>Download the latest version <a href=\"https://repository.brainwavegrc.com/Brainwave/-/packages\">here</a></li>\n<li>Copy the downloaded file to the desired folder:\n<ul>\n<li><code class=\"language-text\">/usr/local/bin</code> when in server mode</li>\n<li>Into the created folder in desktop mode</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"updating-all-containers-minor-versions\">Updating all containers (minor versions)</h2>\n<p>To check for updates, run <code class=\"language-text\">brainwave status</code>.<br>\nIf an update is available, the <code class=\"language-text\">installed version</code> will be lower than the <code class=\"language-text\">latest available version</code>. It will also show up in the console with a <code class=\"language-text\">!!</code> after the <code class=\"language-text\">Latest available version</code> section. For example:</p>\n\n          <codeblockcopytag>XXXX@XXXX:~\\$ brainwave status\r\nInstallation mode:         Server\r\nProject name:              sandbox\r\nClient version:            1.2.21\r\nInstalled version:         1.2.153\r\nLatest available version:  1.2.183                   ‼\r\nRegistry:                  igrcanalytics.azurecr.io\r\nGit configuration:         Valid                     √\r\nImages:                    All present               √\r\nServices                   Stopped                   ‼</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">XXXX@XXXX:~$ brainwave status\r\nInstallation mode:         Server\r\nProject name:              sandbox\r\nClient version:            <span class=\"token number\">1.2</span>.21\r\nInstalled version:         <span class=\"token number\">1.2</span>.153\r\nLatest available version:  <span class=\"token number\">1.2</span>.183                   ‼\r\nRegistry:                  igrcanalytics.azurecr.io\r\nGit configuration:         Valid                     √\r\nImages:                    All present               √\r\nServices                   Stopped                   ‼</code></pre></div>\n<blockquote>\n<p>Please stop the service before performing the upgrade: <code class=\"language-text\">brainwave stop</code></p>\n</blockquote>\n<p>To run the update, the easiest method is to run the following commands:</p>\n\n          <codeblockcopytag>brainwave admin upgrade\r\nbrainwave pull\r\nbrainwave start</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brainwave admin upgrade\r\nbrainwave pull\r\nbrainwave start</code></pre></div>\n<p>For the full list of available option run <code class=\"language-text\">brainwave admin upgrade --help</code>.</p>\n<blockquote>\n<p>To clean the old images, after having performed the above upgrade use <code class=\"language-text\">brainwave admin clean-images</code>.</p>\n</blockquote>\n<p>Use the following to upgrade, pull the new images, delete the old images and restart the service in one command:</p>\n\n          <codeblockcopytag>brainwave admin upgrade --clean-images --pull --start</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brainwave admin upgrade --clean-images <span class=\"token parameter variable\">--pull</span> <span class=\"token parameter variable\">--start</span></code></pre></div>\n<h2 id=\"major-version-upgrade\">Major version upgrade</h2>\n<p>The major upgrade process differs slightly from minor upgrades as you need to upgrade your CLI.<br>\nThis guide is primarily written for a <strong>server install</strong> on a linux platform.<br>\nMost steps after the installation of the CLI should stay the same for a Desktop install.</p>\n<h3 id=\"prerequisites\">Prerequisites</h3>\n<p>Make sure to have your project's repository configured to be our official Gitea repository: repository.brainwavegrc.com/brainwave.<br>\nYou can run <code class=\"language-text\">brainwave status</code> to retrieve that info.<br>\nIf you happen to be on another repository, you will need to modify your .env file (in /usr/local/brainwave):<br>\nChange your REGISTRY_URL variable to : <code class=\"language-text\">repository.brainwavegrc.com/brainwave</code></p>\n<h3 id=\"performing-the-upgrade\">Performing the upgrade</h3>\n<ol>\n<li>Download the new CLI (URL will change depending on platform and version, check <a href=\"https://repository.brainwavegrc.com/Brainwave/-/packages?q=tools&#x26;type=\">the repository</a>):</li>\n</ol>\n\n          <codeblockcopytag>curl --user &quot;username&quot;:&quot;password&quot; --output brainwave https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave\r\ncurl --user &quot;username&quot;:&quot;password&quot; --output brainwave.sha256 https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave.sha256\r\necho &quot;\\$(cat brainwave.sha256)  brainwave&quot; | sha256sum --check</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">--user</span> <span class=\"token string\">\"username\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"password\"</span> <span class=\"token parameter variable\">--output</span> brainwave https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave\r\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">--user</span> <span class=\"token string\">\"username\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"password\"</span> <span class=\"token parameter variable\">--output</span> brainwave.sha256 https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave.sha256\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">cat</span> brainwave.sha256<span class=\"token variable\">)</span></span>  brainwave\"</span> <span class=\"token operator\">|</span> sha256sum <span class=\"token parameter variable\">--check</span></code></pre></div>\n<ol start=\"2\">\n<li>Install to your execution directory:</li>\n</ol>\n\n          <codeblockcopytag>sudo mkdir -p /usr/local/bin\r\nsudo cp brainwave /usr/local/bin/brainwave\r\nsudo chown brainwave:brainwave /usr/local/bin/brainwave\r\nsudo chmod ug+rx /usr/local/bin/brainwave</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /usr/local/bin\r\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> brainwave /usr/local/bin/brainwave\r\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> brainwave:brainwave /usr/local/bin/brainwave\r\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> ug+rx /usr/local/bin/brainwave</code></pre></div>\n<ol start=\"3\">\n<li>(Optional): You can install the binaries to your /usr/bin:</li>\n</ol>\n\n          <codeblockcopytag>sudo cp brainwave /usr/bin/brainwave\r\nsudo chown brainwave:brainwave /usr/bin/brainwave\r\nsudo chmod ug+rx /usr/bin/brainwave</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> brainwave /usr/bin/brainwave\r\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> brainwave:brainwave /usr/bin/brainwave\r\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> ug+rx /usr/bin/brainwave</code></pre></div>\n<ol start=\"4\">\n<li>Run <code class=\"language-text\">brainwave status</code> to check that you are running the right CLI. You should get something like this:</li>\n</ol>\n\n          <codeblockcopytag>Installation mode:  Server\r\nProject name:       brainwave\r\nClient version:     1.4.12\r\nInstalled version:  1.2.198\r\n\r\n× This client version is incompatible with the installed application</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Installation mode:  Server\r\nProject name:       brainwave\r\nClient version:     <span class=\"token number\">1.4</span>.12\r\nInstalled version:  <span class=\"token number\">1.2</span>.198\r\n\r\n× This client version is incompatible with the installed application</code></pre></div>\n<ol start=\"5\">\n<li>Run <code class=\"language-text\">brainwave admin upgrade --clean-images --pull --start</code></li>\n</ol>\n<blockquote>\n<p>If you have an internal database you should have now a functional install of your new version!</p>\n</blockquote>\n<blockquote>\n<p>[!warning] If you run an external database, follow next steps:</p>\n</blockquote>\n<ol>\n<li>Navigate to <code class=\"language-text\">&lt;hostname>/config</code> and go to the Database panel.</li>\n<li>Verify and refill all fields with the appropriate connection information and test the connections, focussing on the username/schema combo. Save when done.</li>\n<li>Restart all container using:</li>\n</ol>\n\n          <codeblockcopytag>brainwave stop\r\nbrainwave start</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brainwave stop\r\nbrainwave start</code></pre></div>\n<h2 id=\"troubleshooting\">Troubleshooting</h2>\n<p>This section aims to list all issues one might encounter during an upgrade and their fixes. If you encounter any new issues please add it to the list, or contact us to do so.</p>\n<h3 id=\"git-issues\">Git issues</h3>\n<h4 id=\"unable-to-create-gitrepossyncgitshallowlock\">Unable to create <code class=\"language-text\">/gitrepos/sync/.git/shallow.lock</code></h4>\n<p>You might see you portal restarting with this error:</p>\n\n          <codeblockcopytag>2023-10-10 09:22:21 Traceback (most recent call last):\r\n2023-10-10 09:22:21   File &quot;docker-init.py&quot;, line 218, in &lt;module&gt;\r\n2023-10-10 09:22:21 FileNotFoundError: [Errno 2] No such file or directory: '/gitrepos/sync/current'</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"log\"><pre class=\"language-log\"><code class=\"language-log\"><span class=\"token date number\">2023-10-10</span> <span class=\"token time number\">09:22:21</span> Traceback <span class=\"token operator\">(</span>most recent call last<span class=\"token operator\">)</span><span class=\"token operator\">:</span>\r\n<span class=\"token date number\">2023-10-10</span> <span class=\"token time number\">09:22:21</span>   File <span class=\"token string\">\"docker-init.py\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">218</span><span class=\"token punctuation\">,</span> in <span class=\"token operator\">&lt;</span>module<span class=\"token operator\">></span>\r\n<span class=\"token date number\">2023-10-10</span> <span class=\"token time number\">09:22:21</span> FileNotFoundError<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Errno <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token property\">No such file or directory:</span> <span class=\"token string\">'/gitrepos/sync/current'</span></code></pre></div>\n<p>And find this error in your <code class=\"language-text\">bwprojectmirror</code> logs:</p>\n\n          <codeblockcopytag>too many failures, aborting {&quot;error&quot;:&quot;Run(git fetch https://repository.brainwavegrc.com/john.doe/AcmeCorp.git 2956094eb17f9133a65c41bb5ad70fccaa44a5fb --verbose --no-progress --prune --no-auto-gc --depth 1): exit status 128: { stdout: \\&quot;\\&quot;, stderr: \\&quot;POST git-upload-pack (69 bytes)\\\\nPOST git-upload-pack (157 bytes)\\\\nfatal: Unable to create '/gitrepos/sync/.git/shallow.lock': File exists.\\\\n\\\\nAnother git process seems to be running in this repository, e.g.\\\\nan editor opened by 'git commit'. Please make sure all processes\\\\nare terminated then try again. If it still fails, a git process\\\\nmay have crashed in this repository earlier:\\\\nremove the file manually to continue.\\&quot; }&quot;,&quot;failCount&quot;:1}</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"log\"><pre class=\"language-log\"><code class=\"language-log\">too many failures<span class=\"token punctuation\">,</span> aborting <span class=\"token operator\">{</span><span class=\"token string\">\"error\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Run(git fetch https://repository.brainwavegrc.com/john.doe/AcmeCorp.git 2956094eb17f9133a65c41bb5ad70fccaa44a5fb --verbose --no-progress --prune --no-auto-gc --depth 1): exit status 128: { stdout: \\\"\\\", stderr: \\\"POST git-upload-pack (69 bytes)\\\\nPOST git-upload-pack (157 bytes)\\\\nfatal: Unable to create '/gitrepos/sync/.git/shallow.lock': File exists.\\\\n\\\\nAnother git process seems to be running in this repository, e.g.\\\\nan editor opened by 'git commit'. Please make sure all processes\\\\nare terminated then try again. If it still fails, a git process\\\\nmay have crashed in this repository earlier:\\\\nremove the file manually to continue.\\\" }\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"failCount\"</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token operator\">}</span></code></pre></div>\n<p>To solve this simply delete the <code class=\"language-text\">shallow.lock</code> mentioned above.</p>\n<ul>\n<li>On a server install you will find it in:</li>\n</ul>\n\n          <codeblockcopytag>/var/lib/brainwave/repos/sync/.git/</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">/var/lib/brainwave/repos/sync/.git/</code></pre></div>\n<ul>\n<li>On a desktop install it will be in:</li>\n</ul>\n\n          <codeblockcopytag>\\\\wsl\\$\\docker-desktop-data\\data\\docker\\volumes\\brainwave_bwgitrepos\\_data\\sync\\.git\\</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>wsl$<span class=\"token punctuation\">\\</span>docker-desktop-data<span class=\"token punctuation\">\\</span>data<span class=\"token punctuation\">\\</span>docker<span class=\"token punctuation\">\\</span>volumes<span class=\"token punctuation\">\\</span>brainwave_bwgitrepos<span class=\"token punctuation\">\\</span>_data<span class=\"token punctuation\">\\</span>sync<span class=\"token punctuation\">\\</span>.git<span class=\"token punctuation\">\\</span></code></pre></div>\n<p>After deleting the file, simply restart the application.</p>\n<h4 id=\"early-eof\">Early EOF</h4>\n<p>You might see you portal restarting with the same error stated above, but with this time this error in your <code class=\"language-text\">bwprojectmirror</code> logs:</p>\n\n          <codeblockcopytag>/brainwave bwprojectmirror run 1672576749be 2923 10 10 13:49:57.453093 too many failures, aborting (&quot;error*:&quot;Run(git fetch\r\nhttps://reposivory.brainwavegrc.com/Brainwave/identityanalytics 42392570332979904c4C041530ab4ta386967ed --verbose --no-progress --prune --no-auto-gc --depth\r\nl): context deadline exceeded: { stdout: \\&quot;\\&quot;, stderr: \\“POST git-tuploaa-pack (69 bytes) \\\\nPOST git-upload-pack (157 bytes) \\\\nfatal: early BOR.”}&quot;, &quot;failcount&quot;:1}\r\n</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"log\"><pre class=\"language-log\"><code class=\"language-log\"><span class=\"token file-path string\">/brainwave</span> bwprojectmirror run <span class=\"token number\">1672576749be</span> <span class=\"token date number\">2923 10 10</span> <span class=\"token time number\">13:49:57.453093</span> too many failures<span class=\"token punctuation\">,</span> aborting <span class=\"token operator\">(</span><span class=\"token string\">\"error*:\"</span>Run<span class=\"token operator\">(</span>git fetch\r\n<span class=\"token url\">https://reposivory.brainwavegrc.com/Brainwave/identityanalytics</span> 42392570332979904c4C041530ab4ta386967ed <span class=\"token operator\">-</span><span class=\"token operator\">-</span>verbose <span class=\"token operator\">-</span><span class=\"token operator\">-</span>no<span class=\"token operator\">-</span>progress <span class=\"token operator\">-</span><span class=\"token operator\">-</span>prune <span class=\"token operator\">-</span><span class=\"token operator\">-</span>no<span class=\"token operator\">-</span>auto<span class=\"token operator\">-</span>gc <span class=\"token operator\">-</span><span class=\"token operator\">-</span>depth\r\nl<span class=\"token operator\">)</span><span class=\"token operator\">:</span> context deadline exceeded<span class=\"token operator\">:</span> <span class=\"token operator\">{</span> stdout<span class=\"token operator\">:</span> \\<span class=\"token string\">\"\\\", stderr: \\“POST git-tuploaa-pack (69 bytes) \\\\nPOST git-upload-pack (157 bytes) \\\\nfatal: early BOR.”}\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"failcount\"</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token operator\">}</span>\r\n</code></pre></div>\n<p>This error basically means that git fails to pull the whole commit/repository.<br>\nIt mostly happens during large pulls/clones, especially when there is a slow connection/connectivity issues between local and remote.</p>\n<p>To unlock the situation you can:</p>\n<ol>\n<li>Open a terminal and navigate to the folder containing your docker-compose.yml file (<code class=\"language-text\">/usr/local/brainwave</code> on a server install and .brainwave folder on a desktop install).</li>\n<li>Run <code class=\"language-text\">docker compose run --entrypoint=/bin/sh bwprojectmirror</code></li>\n<li>Run <code class=\"language-text\">cd gitrepos/sync</code></li>\n<li>Run <code class=\"language-text\">git pull</code></li>\n</ol>\n<p>This forces the pull operation manually. After this simply restart the application</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{"id":"upgrading-the-application"},"children":[{"type":"text","value":"Upgrading the application"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"[!warning] It is "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"always"}]},{"type":"text","value":" recommended to perform a backup of the application before running the upgrade."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nSee "},{"type":"element","tagName":"a","properties":{"href":"backup-restore.md"},"children":[{"type":"text","value":"here"}]},{"type":"text","value":" for more information"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"upgrading-the-cli"},"children":[{"type":"text","value":"Upgrading the CLI"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To upgrade the version of the CLI."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Download the latest version "},{"type":"element","tagName":"a","properties":{"href":"https://repository.brainwavegrc.com/Brainwave/-/packages"},"children":[{"type":"text","value":"here"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Copy the downloaded file to the desired folder:\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/usr/local/bin"}]},{"type":"text","value":" when in server mode"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Into the created folder in desktop mode"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"updating-all-containers-minor-versions"},"children":[{"type":"text","value":"Updating all containers (minor versions)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To check for updates, run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave status"}]},{"type":"text","value":"."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nIf an update is available, the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"installed version"}]},{"type":"text","value":" will be lower than the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"latest available version"}]},{"type":"text","value":". It will also show up in the console with a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"!!"}]},{"type":"text","value":" after the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Latest available version"}]},{"type":"text","value":" section. For example:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"XXXX@XXXX:~\\$ brainwave status\nInstallation mode:         Server\nProject name:              sandbox\nClient version:            1.2.21\nInstalled version:         1.2.153\nLatest available version:  1.2.183                   ‼\nRegistry:                  igrcanalytics.azurecr.io\nGit configuration:         Valid                     √\nImages:                    All present               √\nServices                   Stopped                   ‼"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"XXXX@XXXX:~$ brainwave status\nInstallation mode:         Server\nProject name:              sandbox\nClient version:            "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1.2"}]},{"type":"text","value":".21\nInstalled version:         "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1.2"}]},{"type":"text","value":".153\nLatest available version:  "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1.2"}]},{"type":"text","value":".183                   ‼\nRegistry:                  igrcanalytics.azurecr.io\nGit configuration:         Valid                     √\nImages:                    All present               √\nServices                   Stopped                   ‼"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Please stop the service before performing the upgrade: "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave stop"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To run the update, the easiest method is to run the following commands:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"brainwave admin upgrade\nbrainwave pull\nbrainwave start"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"brainwave admin upgrade\nbrainwave pull\nbrainwave start"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For the full list of available option run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave admin upgrade --help"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To clean the old images, after having performed the above upgrade use "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave admin clean-images"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Use the following to upgrade, pull the new images, delete the old images and restart the service in one command:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"brainwave admin upgrade --clean-images --pull --start"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"brainwave admin upgrade --clean-images "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--pull"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--start"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"major-version-upgrade"},"children":[{"type":"text","value":"Major version upgrade"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The major upgrade process differs slightly from minor upgrades as you need to upgrade your CLI."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nThis guide is primarily written for a "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"server install"}]},{"type":"text","value":" on a linux platform."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nMost steps after the installation of the CLI should stay the same for a Desktop install."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"prerequisites"},"children":[{"type":"text","value":"Prerequisites"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Make sure to have your project's repository configured to be our official Gitea repository: repository.brainwavegrc.com/brainwave."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nYou can run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave status"}]},{"type":"text","value":" to retrieve that info."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nIf you happen to be on another repository, you will need to modify your .env file (in /usr/local/brainwave):"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nChange your REGISTRY_URL variable to : "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"repository.brainwavegrc.com/brainwave"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"performing-the-upgrade"},"children":[{"type":"text","value":"Performing the upgrade"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Download the new CLI (URL will change depending on platform and version, check "},{"type":"element","tagName":"a","properties":{"href":"https://repository.brainwavegrc.com/Brainwave/-/packages?q=tools&type="},"children":[{"type":"text","value":"the repository"}]},{"type":"text","value":"):"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"curl --user \"username\":\"password\" --output brainwave https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave\ncurl --user \"username\":\"password\" --output brainwave.sha256 https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave.sha256\necho \"\\$(cat brainwave.sha256)  brainwave\" | sha256sum --check"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"curl"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--user"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"username\""}]},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"password\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--output"}]},{"type":"text","value":" brainwave https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"curl"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--user"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"username\""}]},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"password\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--output"}]},{"type":"text","value":" brainwave.sha256 https://repository.brainwavegrc.com/api/packages/Brainwave/generic/brainwavetools_linux_amd64/1.4/brainwave.sha256\n"},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"echo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\""},{"type":"element","tagName":"span","properties":{"className":["token","variable"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","variable"]},"children":[{"type":"text","value":"$("}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"cat"}]},{"type":"text","value":" brainwave.sha256"},{"type":"element","tagName":"span","properties":{"className":["token","variable"]},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"  brainwave\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"|"}]},{"type":"text","value":" sha256sum "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--check"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":2},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Install to your execution directory:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"sudo mkdir -p /usr/local/bin\nsudo cp brainwave /usr/local/bin/brainwave\nsudo chown brainwave:brainwave /usr/local/bin/brainwave\nsudo chmod ug+rx /usr/local/bin/brainwave"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"mkdir"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"-p"}]},{"type":"text","value":" /usr/local/bin\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"cp"}]},{"type":"text","value":" brainwave /usr/local/bin/brainwave\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"chown"}]},{"type":"text","value":" brainwave:brainwave /usr/local/bin/brainwave\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"chmod"}]},{"type":"text","value":" ug+rx /usr/local/bin/brainwave"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":3},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"(Optional): You can install the binaries to your /usr/bin:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"sudo cp brainwave /usr/bin/brainwave\nsudo chown brainwave:brainwave /usr/bin/brainwave\nsudo chmod ug+rx /usr/bin/brainwave"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"cp"}]},{"type":"text","value":" brainwave /usr/bin/brainwave\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"chown"}]},{"type":"text","value":" brainwave:brainwave /usr/bin/brainwave\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"chmod"}]},{"type":"text","value":" ug+rx /usr/bin/brainwave"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":4},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave status"}]},{"type":"text","value":" to check that you are running the right CLI. You should get something like this:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"Installation mode:  Server\nProject name:       brainwave\nClient version:     1.4.12\nInstalled version:  1.2.198\n\n× This client version is incompatible with the installed application"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"Installation mode:  Server\nProject name:       brainwave\nClient version:     "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1.4"}]},{"type":"text","value":".12\nInstalled version:  "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1.2"}]},{"type":"text","value":".198\n\n× This client version is incompatible with the installed application"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":5},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"brainwave admin upgrade --clean-images --pull --start"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you have an internal database you should have now a functional install of your new version!"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"[!warning] If you run an external database, follow next steps:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Navigate to "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"<hostname>/config"}]},{"type":"text","value":" and go to the Database panel."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Verify and refill all fields with the appropriate connection information and test the connections, focussing on the username/schema combo. Save when done."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Restart all container using:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"brainwave stop\nbrainwave start"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"brainwave stop\nbrainwave start"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"troubleshooting"},"children":[{"type":"text","value":"Troubleshooting"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This section aims to list all issues one might encounter during an upgrade and their fixes. If you encounter any new issues please add it to the list, or contact us to do so."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"git-issues"},"children":[{"type":"text","value":"Git issues"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"unable-to-create-gitrepossyncgitshallowlock"},"children":[{"type":"text","value":"Unable to create "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/gitrepos/sync/.git/shallow.lock"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You might see you portal restarting with this error:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"2023-10-10 09:22:21 Traceback (most recent call last):\n2023-10-10 09:22:21   File \"docker-init.py\", line 218, in <module>\n2023-10-10 09:22:21 FileNotFoundError: [Errno 2] No such file or directory: '/gitrepos/sync/current'"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"log"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-log"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-log"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","date","number"]},"children":[{"type":"text","value":"2023-10-10"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","time","number"]},"children":[{"type":"text","value":"09:22:21"}]},{"type":"text","value":" Traceback "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"most recent call last"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","date","number"]},"children":[{"type":"text","value":"2023-10-10"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","time","number"]},"children":[{"type":"text","value":"09:22:21"}]},{"type":"text","value":"   File "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"docker-init.py\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" line "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"218"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" in "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"module"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","date","number"]},"children":[{"type":"text","value":"2023-10-10"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","time","number"]},"children":[{"type":"text","value":"09:22:21"}]},{"type":"text","value":" FileNotFoundError"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"Errno "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"No such file or directory:"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'/gitrepos/sync/current'"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And find this error in your "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"bwprojectmirror"}]},{"type":"text","value":" logs:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"too many failures, aborting {\"error\":\"Run(git fetch https://repository.brainwavegrc.com/john.doe/AcmeCorp.git 2956094eb17f9133a65c41bb5ad70fccaa44a5fb --verbose --no-progress --prune --no-auto-gc --depth 1): exit status 128: { stdout: \\\"\\\", stderr: \\\"POST git-upload-pack (69 bytes)\\\\nPOST git-upload-pack (157 bytes)\\\\nfatal: Unable to create '/gitrepos/sync/.git/shallow.lock': File exists.\\\\n\\\\nAnother git process seems to be running in this repository, e.g.\\\\nan editor opened by 'git commit'. Please make sure all processes\\\\nare terminated then try again. If it still fails, a git process\\\\nmay have crashed in this repository earlier:\\\\nremove the file manually to continue.\\\" }\",\"failCount\":1}"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"log"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-log"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-log"]},"children":[{"type":"text","value":"too many failures"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" aborting "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"error\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"Run(git fetch https://repository.brainwavegrc.com/john.doe/AcmeCorp.git 2956094eb17f9133a65c41bb5ad70fccaa44a5fb --verbose --no-progress --prune --no-auto-gc --depth 1): exit status 128: { stdout: \\\"\\\", stderr: \\\"POST git-upload-pack (69 bytes)\\\\nPOST git-upload-pack (157 bytes)\\\\nfatal: Unable to create '/gitrepos/sync/.git/shallow.lock': File exists.\\\\n\\\\nAnother git process seems to be running in this repository, e.g.\\\\nan editor opened by 'git commit'. Please make sure all processes\\\\nare terminated then try again. If it still fails, a git process\\\\nmay have crashed in this repository earlier:\\\\nremove the file manually to continue.\\\" }\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"failCount\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To solve this simply delete the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"shallow.lock"}]},{"type":"text","value":" mentioned above."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"On a server install you will find it in:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"/var/lib/brainwave/repos/sync/.git/"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sh"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sh"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"/var/lib/brainwave/repos/sync/.git/"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"On a desktop install it will be in:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"\\\\wsl\\$\\docker-desktop-data\\data\\docker\\volumes\\brainwave_bwgitrepos\\_data\\sync\\.git\\"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sh"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sh"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"wsl$"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"docker-desktop-data"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"data"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"docker"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"volumes"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"brainwave_bwgitrepos"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"_data"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"sync"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":".git"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After deleting the file, simply restart the application."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"early-eof"},"children":[{"type":"text","value":"Early EOF"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You might see you portal restarting with the same error stated above, but with this time this error in your "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"bwprojectmirror"}]},{"type":"text","value":" logs:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"/brainwave bwprojectmirror run 1672576749be 2923 10 10 13:49:57.453093 too many failures, aborting (\"error*:\"Run(git fetch\nhttps://reposivory.brainwavegrc.com/Brainwave/identityanalytics 42392570332979904c4C041530ab4ta386967ed --verbose --no-progress --prune --no-auto-gc --depth\nl): context deadline exceeded: { stdout: \\\"\\\", stderr: \\“POST git-tuploaa-pack (69 bytes) \\\\nPOST git-upload-pack (157 bytes) \\\\nfatal: early BOR.”}\", \"failcount\":1}\n"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"log"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-log"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-log"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","file-path","string"]},"children":[{"type":"text","value":"/brainwave"}]},{"type":"text","value":" bwprojectmirror run "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1672576749be"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","date","number"]},"children":[{"type":"text","value":"2923 10 10"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","time","number"]},"children":[{"type":"text","value":"13:49:57.453093"}]},{"type":"text","value":" too many failures"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" aborting "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"error*:\""}]},{"type":"text","value":"Run"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"git fetch\n"},{"type":"element","tagName":"span","properties":{"className":["token","url"]},"children":[{"type":"text","value":"https://reposivory.brainwavegrc.com/Brainwave/identityanalytics"}]},{"type":"text","value":" 42392570332979904c4C041530ab4ta386967ed "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"verbose "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"no"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"progress "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"prune "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"no"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"auto"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gc "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"depth\nl"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" context deadline exceeded"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" stdout"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" \\"},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"\\\", stderr: \\“POST git-tuploaa-pack (69 bytes) \\\\nPOST git-upload-pack (157 bytes) \\\\nfatal: early BOR.”}\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"failcount\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This error basically means that git fails to pull the whole commit/repository."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nIt mostly happens during large pulls/clones, especially when there is a slow connection/connectivity issues between local and remote."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To unlock the situation you can:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Open a terminal and navigate to the folder containing your docker-compose.yml file ("},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/usr/local/brainwave"}]},{"type":"text","value":" on a server install and .brainwave folder on a desktop install)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"docker compose run --entrypoint=/bin/sh bwprojectmirror"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"cd gitrepos/sync"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"git pull"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This forces the pull operation manually. After this simply restart the application"}]}],"data":{"quirksMode":false}},"fileAbsolutePath":"/home/runner/work/developer-site/developer-site/.cache/gatsby-source-git/ia/version-1.4/documentation/run-ops/upgrading.md","frontmatter":{"title":"Solution Upgrades"},"headings":[{"id":"upgrading-the-application","value":"Upgrading the application","depth":1},{"id":"upgrading-the-cli","value":"Upgrading the CLI","depth":2},{"id":"updating-all-containers-minor-versions","value":"Updating all containers (minor versions)","depth":2},{"id":"major-version-upgrade","value":"Major version upgrade","depth":2},{"id":"prerequisites","value":"Prerequisites","depth":3},{"id":"performing-the-upgrade","value":"Performing the upgrade","depth":3},{"id":"troubleshooting","value":"Troubleshooting","depth":2},{"id":"git-issues","value":"Git issues","depth":3},{"id":"unable-to-create-gitrepossyncgitshallowlock","value":"Unable to create <code class=\"language-text\">/gitrepos/sync/.git/shallow.lock</code>","depth":4},{"id":"early-eof","value":"Early EOF","depth":4}]},"toc":{"html":"<ul>\n<li><a href=\"preface.md\">Preface</a></li>\n<li><a href=\"backup-restore.md\">Backup and Restore</a></li>\n<li><a href=\"purge.md\">Data Purging</a></li>\n<li><a href=\"upgrading.md\">Upgrading</a></li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"preface.md"},"children":[{"type":"text","value":"Preface"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"backup-restore.md"},"children":[{"type":"text","value":"Backup and Restore"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"purge.md"},"children":[{"type":"text","value":"Data Purging"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"upgrading.md"},"children":[{"type":"text","value":"Upgrading"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"fileAbsolutePath":"/home/runner/work/developer-site/developer-site/.cache/gatsby-source-git/ia/version-1.4/documentation/run-ops/TOC.md","frontmatter":{"title":"System Requirements"}}},"pageContext":{"urlPrefix":"ia/version-1.4","absolutePath":"/home/runner/work/developer-site/developer-site/.cache/gatsby-source-git/ia/version-1.4/documentation/run-ops/upgrading.md","tocRegex":"/(ia/)(version-1.4/)?(documentation/)?(run-ops/)?(upgrading.md/)?(TOC.md)/ig","versions":[{"name":"version-1.5","displayName":"v1.5"},{"name":"version-1.4","displayName":"v1.4"},{"name":"version-1.2","displayName":"v1.2"}],"currentRepo":{"name":"ia","displayName":"Identity Analytics","description":"This guide provides a high-level overview of Identity Analytics. This documentation includes the user guides, integration guides for Identity Analytics along with the different modules included.","links":[{"text":"SEE SELF-MANAGED GUIDES","href":"/ia/version-1.4/#2"}],"remote":"https://github.com/radiantlogic-v8/documentation-ia-selfmanaged.git","patterns":["home-pages/**","documentation/**"],"deployBranches":[{"name":"version-1.5","displayName":"v1.5"},{"name":"version-1.4","displayName":"v1.4"},{"name":"version-1.2","displayName":"v1.2"}]},"currentRepoWebLink":"https://github.com/radiantlogic-v8/documentation-ia-selfmanaged","currentVersion":{"name":"version-1.4","displayName":"v1.4"},"title":"Solution Upgrades","description":"Identity Analytics self-managed solution upgrade guides","tocForCurrentSection":{"textElement":"Run ops","href":null,"children":[{"textElement":"Backup restore","href":"run-ops/backup-restore","children":[]},{"textElement":"Preface","href":"run-ops/preface","children":[]},{"textElement":"Purge","href":"run-ops/purge","children":[]},{"textElement":"Reconciliation","href":"run-ops/reconciliation","children":[]},{"textElement":"T O C","href":"run-ops/TOC","children":[]},{"textElement":"Upgrading","href":"run-ops/upgrading","children":[]}]}}},"staticQueryHashes":["63159454"],"slicesMap":{"footer":"footer","header":"header"}}