{"componentChunkName":"component---src-templates-base-page-js","path":"/ia/descartes/how-to/database/postgresql/psql-performance-issue-investigation/","result":{"data":{"pageContent":{"html":"<h1 id=\"performance-investigation-in-postgresql\">Performance investigation in postgresql</h1>\n<p>In order to efficiently investigate performance issues, some information on Brainwave iGRC's infrastructure and configuration is required, such as :</p>\n<ul>\n<li>The list of parameters</li>\n<li>The sizing of the database</li>\n<li>The sizing of objects (Table, Index)</li>\n<li>And so on</li>\n</ul>\n<p>This article includes a SQL script, as  well as it's the associated documentation. The results should be sent to Brainwave's support service to aide in the resolution of performance issues.</p>\n<h2 id=\"prerequisites\">Prerequisites</h2>\n<p>The scripts have been tested on the PostgreSQL database versions 9.6.<br>\nAn instance of PSQL must be used to perform the data extraction.<br>\nAn Postgres system account to retrieve all information as all parameters of database or sizing of this one.</p>\n<h2 id=\"procedure\">Procedure</h2>\n<p>In order to run the provided SQL scripts it is necessary to :</p>\n<ul>\n<li>Copy the <code class=\"language-text\">DBCheck_PostgreSQL_Vxx.sql</code> file into a folder while ensuring that it can be accessed by the PostgreSQL account. (On Linux, <code class=\"language-text\">chmod –R 777 &lt;folder></code>)</li>\n<li>Execute the script <code class=\"language-text\">DBCheck_PostgreSQL_Vxx.sql</code> within a PSQL session and using the <code class=\"language-text\">postgres</code> system account.</li>\n</ul>\n<blockquote>\n<p>If your database schema is not \"igrc\", please modify the script file accordingly. Replace \"igrc\" by the name of your schema.</p>\n</blockquote>\n<p>The following commands allow you to run the script and output the results to the <code class=\"language-text\">/tmp/results_db_check.txt</code> file:</p>\n\n          <codeblockcopytag>psql -h hostname -p 5432 -d database_name -U postgres -f &lt;absolute path to file&gt;/DBcheck_postgreSQL_Vxx.sql &gt; /tmp/results_db_check.txt</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">psql <span class=\"token parameter variable\">-h</span> <span class=\"token function\">hostname</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">5432</span> <span class=\"token parameter variable\">-d</span> database_name <span class=\"token parameter variable\">-U</span> postgres <span class=\"token parameter variable\">-f</span> <span class=\"token operator\">&lt;</span>absolute path to file<span class=\"token operator\">></span>/DBcheck_postgreSQL_Vxx.sql <span class=\"token operator\">></span> /tmp/results_db_check.txt</code></pre></div>\n<p>Please send the resulting output file to Brainwave iGRC's support team.</p>\n<h2 id=\"long-queries\">Long queries</h2>\n<p>In addition it can be interesting to list the long queries being executed in the database. To do so please execute the following sql request:</p>\n\n          <codeblockcopytag>-- List long queries on PostgreSQL\r\nSELECT\r\n  pid,\r\n  pg_stat_activity.query_start,\r\n  now() - pg_stat_activity.query_start AS duration,\r\n  query,\r\n  state\r\nFROM pg_stat_activity\r\nWHERE (now() - pg_stat_activity.query_start) &gt; interval '5 minutes' and state = 'active';</codeblockcopytag>\n          \n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- List long queries on PostgreSQL</span>\r\n<span class=\"token keyword\">SELECT</span>\r\n  pid<span class=\"token punctuation\">,</span>\r\n  pg_stat_activity<span class=\"token punctuation\">.</span>query_start<span class=\"token punctuation\">,</span>\r\n  <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> pg_stat_activity<span class=\"token punctuation\">.</span>query_start <span class=\"token keyword\">AS</span> duration<span class=\"token punctuation\">,</span>\r\n  query<span class=\"token punctuation\">,</span>\r\n  state\r\n<span class=\"token keyword\">FROM</span> pg_stat_activity\r\n<span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> pg_stat_activity<span class=\"token punctuation\">.</span>query_start<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token keyword\">interval</span> <span class=\"token string\">'5 minutes'</span> <span class=\"token operator\">and</span> state <span class=\"token operator\">=</span> <span class=\"token string\">'active'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"downloads\">Downloads</h2>\n<p>All scripts are available for download at the following links:</p>\n<ul>\n<li><a href=\"./assets/DBCheck_PostgreSQL_v10.sql\">DBCheck_PostgreSQL_V10.sql</a></li>\n<li><a href=\"./assets/DBCheck_PostgreSQL_v9.sql\">DBCheck_PostgreSQL_V9.sql</a></li>\n<li><a href=\"./assets/DBCheck_PostgreSQL_v8.sql\">DBCheck_PostgreSQL_V8.sql</a></li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{"id":"performance-investigation-in-postgresql"},"children":[{"type":"text","value":"Performance investigation in postgresql"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In order to efficiently investigate performance issues, some information on Brainwave iGRC's infrastructure and configuration is required, such as :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The list of parameters"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The sizing of the database"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The sizing of objects (Table, Index)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"And so on"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This article includes a SQL script, as  well as it's the associated documentation. The results should be sent to Brainwave's support service to aide in the resolution of performance issues."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"prerequisites"},"children":[{"type":"text","value":"Prerequisites"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The scripts have been tested on the PostgreSQL database versions 9.6."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nAn instance of PSQL must be used to perform the data extraction."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nAn Postgres system account to retrieve all information as all parameters of database or sizing of this one."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"procedure"},"children":[{"type":"text","value":"Procedure"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In order to run the provided SQL scripts it is necessary to :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Copy the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"DBCheck_PostgreSQL_Vxx.sql"}]},{"type":"text","value":" file into a folder while ensuring that it can be accessed by the PostgreSQL account. (On Linux, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"chmod –R 777 <folder>"}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Execute the script "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"DBCheck_PostgreSQL_Vxx.sql"}]},{"type":"text","value":" within a PSQL session and using the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"postgres"}]},{"type":"text","value":" system account."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If your database schema is not \"igrc\", please modify the script file accordingly. Replace \"igrc\" by the name of your schema."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The following commands allow you to run the script and output the results to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/tmp/results_db_check.txt"}]},{"type":"text","value":" file:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"psql -h hostname -p 5432 -d database_name -U postgres -f <absolute path to file>/DBcheck_postgreSQL_Vxx.sql > /tmp/results_db_check.txt"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"psql "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"-h"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"hostname"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"-p"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5432"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"-d"}]},{"type":"text","value":" database_name "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"-U"}]},{"type":"text","value":" postgres "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"-f"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"absolute path to file"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"/DBcheck_postgreSQL_Vxx.sql "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" /tmp/results_db_check.txt"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Please send the resulting output file to Brainwave iGRC's support team."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"long-queries"},"children":[{"type":"text","value":"Long queries"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In addition it can be interesting to list the long queries being executed in the database. To do so please execute the following sql request:"}]},{"type":"text","value":"\n\n          "},{"type":"element","tagName":"codeblockcopytag","properties":{},"children":[{"type":"text","value":"-- List long queries on PostgreSQL\nSELECT\n  pid,\n  pg_stat_activity.query_start,\n  now() - pg_stat_activity.query_start AS duration,\n  query,\n  state\nFROM pg_stat_activity\nWHERE (now() - pg_stat_activity.query_start) > interval '5 minutes' and state = 'active';"}]},{"type":"text","value":"\n          \n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- List long queries on PostgreSQL"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":"\n  pid"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  pg_stat_activity"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"query_start"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" pg_stat_activity"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"query_start "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"AS"}]},{"type":"text","value":" duration"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  query"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  state\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" pg_stat_activity\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" pg_stat_activity"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"query_start"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"interval"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'5 minutes'"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"and"}]},{"type":"text","value":" state "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'active'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"downloads"},"children":[{"type":"text","value":"Downloads"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"All scripts are available for download at the following links:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"./assets/DBCheck_PostgreSQL_v10.sql"},"children":[{"type":"text","value":"DBCheck_PostgreSQL_V10.sql"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"./assets/DBCheck_PostgreSQL_v9.sql"},"children":[{"type":"text","value":"DBCheck_PostgreSQL_V9.sql"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"./assets/DBCheck_PostgreSQL_v8.sql"},"children":[{"type":"text","value":"DBCheck_PostgreSQL_V8.sql"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"fileAbsolutePath":"/home/runner/work/developer-site/developer-site/.cache/gatsby-source-git/ia/descartes/documentation/how-to/database/postgresql/psql-performance-issue-investigation.md","frontmatter":{"title":"Performance investigation in postgresql"},"headings":[{"id":"performance-investigation-in-postgresql","value":"Performance investigation in postgresql","depth":1},{"id":"prerequisites","value":"Prerequisites","depth":2},{"id":"procedure","value":"Procedure","depth":2},{"id":"long-queries","value":"Long queries","depth":2},{"id":"downloads","value":"Downloads","depth":2}]},"toc":null},"pageContext":{"urlPrefix":"ia/descartes","absolutePath":"/home/runner/work/developer-site/developer-site/.cache/gatsby-source-git/ia/descartes/documentation/how-to/database/postgresql/psql-performance-issue-investigation.md","tocRegex":"/(ia/)(descartes/)?(documentation/)?(how-to/)?(database/)?(postgresql/)?(psql-performance-issue-investigation.md/)?(TOC.md)/ig","versions":[{"name":"descartes","displayName":"Descartes"}],"currentRepo":{"name":"ia","displayName":"Identity Analytics","description":"This guide provides a high-level overview of Identity Analytics. This documentation includes the user guides, integration guides for Identity Analytics along with the different modules included.","links":[{"text":"SEE DEVELOPER DOCUMENTATION","href":"/ia/descartes/#1"}],"remote":"https://github.com/radiantlogic-v8/documentation-ia-product.git","patterns":["home-pages/**","documentation/**"],"deployBranches":[{"name":"descartes","displayName":"Descartes"}]},"currentRepoWebLink":"https://github.com/radiantlogic-v8/documentation-ia-product","currentVersion":{"name":"descartes","displayName":"Descartes"},"title":"Performance investigation in postgresql","description":"How-To help the support team to investigate performance issues when using an PostgreSQL database","tocForCurrentSection":{"textElement":"How to","href":null,"children":[{"textElement":"Database","href":null,"children":[{"textElement":"Install sql server oracle jdbc drivers","href":"how-to/database/install-sql-server-oracle-jdbc-drivers","children":[]},{"textElement":"Oracle","href":null,"children":[{"textElement":"Install orcl driver","href":"how-to/database/oracle/install-orcl-driver","children":[]},{"textElement":"Performance investigation oracle","href":"how-to/database/oracle/performance-investigation-oracle","children":[]}]},{"textElement":"Postgresql","href":null,"children":[{"textElement":"Psql performance issue investigation","href":"how-to/database/postgresql/psql-performance-issue-investigation","children":[]}]},{"textElement":"Sqlserver","href":null,"children":[{"textElement":"Install sqlserver driver","href":"how-to/database/sqlserver/install-sqlserver-driver","children":[]},{"textElement":"Performance investigation sql server","href":"how-to/database/sqlserver/performance-investigation-sql-server","children":[]}]}]},{"textElement":"Workflow","href":null,"children":[{"textElement":"Reference timeslots","href":"how-to/workflow/reference-timeslots","children":[]},{"textElement":"Upgrade activiti","href":"how-to/workflow/upgrade-activiti","children":[]}]}]}}},"staticQueryHashes":["63159454"],"slicesMap":{"footer":"footer","header":"header"}}